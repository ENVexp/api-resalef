<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Streaming with MSE</title>
</head>
<body>

  <video id="video" controls autoplay></video>

  <script>
    // Função para pegar o valor do query param
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    // Obtendo o link do vídeo via query param 'name'
    const videoUrl = getQueryParam('name');  // Ex: ?name=https://example.com/video.mp4

    if (videoUrl) {
      const videoElement = document.getElementById('video');
      const mediaSource = new MediaSource();
      videoElement.src = URL.createObjectURL(mediaSource);

      mediaSource.addEventListener('sourceopen', () => {
        const sourceBuffer = mediaSource.addSourceBuffer('video/mp4; codecs="avc1.64001F, mp4a.40.2"');

        fetch(videoUrl)  // Usando o link do vídeo obtido nos query params
          .then(response => response.arrayBuffer())
          .then(data => {
            sourceBuffer.appendBuffer(data);
          })
          .catch(error => console.error('Erro ao carregar o vídeo:', error));
      });
    } else {
      console.error('Nenhum link de vídeo fornecido nos query params.');
    }
  </script>

</body>
</html>
